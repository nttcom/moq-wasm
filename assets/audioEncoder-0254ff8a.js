(function(){"use strict";let n;const s={codec:"opus",sampleRate:48e3,numberOfChannels:1,bitrate:64e3};function i(o,e){self.postMessage({chunk:o,metadata:e})}async function c(){const o={output:i,error:a=>{console.log(a.message)}},e=new AudioEncoder(o);return e.configure(s),e}async function r(o){n||(n=await c());const e=o.getReader();for(;;){const a=await e.read();if(a.done)break;const t=a.value;n.encode(t),t.close()}}self.onmessage=async o=>{const e=o.data.audioStream;if(!e){console.error("MediaStreamTrack が渡されていません");return}await r(e)}})();
