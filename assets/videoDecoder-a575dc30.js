var _=Object.defineProperty;var g=(a,n,c)=>n in a?_(a,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[n]=c;var d=(a,n,c)=>(g(a,typeof n!="symbol"?n+"":n,c),c);(function(){"use strict";class c{constructor(e=1800){d(this,"buffer",[]);d(this,"minDelayMs",500);this.maxBufferSize=e}push(e,r,s){const o=performance.now(),u={groupId:e,objectId:r,timestamp:o,object:s},y=this.findInsertPos(e,r);this.buffer.splice(y,0,u),this.buffer.length>this.maxBufferSize&&(console.warn("JitterBuffer is full, removing the oldest element"),this.buffer.shift())}pop(){if(this.buffer.length===0)return null;const e=this.buffer[0];return performance.now()-e.timestamp<this.minDelayMs?null:(this.buffer.shift(),e.object)}findInsertPos(e,r){for(let s=this.buffer.length-1;s>=0;s--){const o=this.buffer[s];if(o.groupId===e&&o.objectId<r||o.groupId<e)return s+1}return 0}}function b(t){self.postMessage({frame:t}),t.close()}let i;const l={codec:"av01.0.08M.08",width:1920,height:1080,scalabilityMode:"L1T1"};async function h(){const t={output:b,error:r=>{console.log(r.message),i=void 0}},e=new VideoDecoder(t);return await e.configure(l),e}const p=5,f=new c;setInterval(()=>{const t=f.pop();t&&m(t)},p),self.onmessage=async t=>{const e={objectId:t.data.subgroupStreamObject.object_id,objectPayloadLength:t.data.subgroupStreamObject.object_payload_length,objectPayload:t.data.subgroupStreamObject.object_payload,objectStatus:t.data.subgroupStreamObject.object_status};f.push(t.data.groupId,e.objectId,e)};async function m(t){const e=new Uint8Array(t.objectPayload),s=new TextDecoder().decode(e),o=JSON.parse(s),u=new EncodedVideoChunk({type:o.chunk.type,timestamp:o.chunk.timestamp,duration:o.chunk.duration,data:new Uint8Array(o.chunk.data)});!i&&(i=await h(),o.chunk.type!=="key")||await i.decode(u)}})();
