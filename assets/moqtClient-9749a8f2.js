var ae=Object.defineProperty;var ue=(n,e,t)=>e in n?ae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var l=(n,e,t)=>(ue(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const _ of o.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&s(_)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();let r;function m(n){const e=r.__externref_table_alloc();return r.__wbindgen_export_2.set(e,n),e}function d(n,e){try{return n.apply(this,e)}catch(t){const s=m(t);r.__wbindgen_exn_store(s)}}const te=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&te.decode();let j=null;function y(){return(j===null||j.byteLength===0)&&(j=new Uint8Array(r.memory.buffer)),j}function g(n,e){return n=n>>>0,te.decode(y().subarray(n,n+e))}let a=0;const F=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},be=typeof F.encodeInto=="function"?function(n,e){return F.encodeInto(n,e)}:function(n,e){const t=F.encode(n);return e.set(t),{read:n.length,written:t.length}};function b(n,e,t){if(t===void 0){const c=F.encode(n),u=e(c.length,1)>>>0;return y().subarray(u,u+c.length).set(c),a=c.length,u}let s=n.length,i=e(s,1)>>>0;const o=y();let _=0;for(;_<s;_++){const c=n.charCodeAt(_);if(c>127)break;o[i+_]=c}if(_!==s){_!==0&&(n=n.slice(_)),i=t(i,s,s=_+n.length*3,1)>>>0;const c=y().subarray(i+_,i+s),u=be(n,c);_+=u.written,i=t(i,s,_,1)>>>0}return a=_,i}let f=null;function w(){return(f===null||f.buffer.detached===!0||f.buffer.detached===void 0&&f.buffer!==r.memory.buffer)&&(f=new DataView(r.memory.buffer)),f}function h(n){return n==null}const W=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>{r.__wbindgen_export_6.get(n.dtor)(n.a,n.b)});function ge(n,e,t,s){const i={a:n,b:e,cnt:1,dtor:t},o=(..._)=>{i.cnt++;const c=i.a;i.a=0;try{return s(c,i.b,..._)}finally{--i.cnt===0?(r.__wbindgen_export_6.get(i.dtor)(c,i.b),W.unregister(i)):i.a=c}};return o.original=i,W.register(o,i,i),o}function v(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const i=n.description;return i==null?"Symbol":`Symbol(${i})`}if(e=="function"){const i=n.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(n)){const i=n.length;let o="[";i>0&&(o+=v(n[0]));for(let _=1;_<i;_++)o+=", "+v(n[_]);return o+="]",o}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let s;if(t&&t.length>1)s=t[1];else return toString.call(n);if(s=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:s}function S(n,e){n=n>>>0;const t=w(),s=[];for(let i=n;i<n+4*e;i+=4)s.push(r.__wbindgen_export_2.get(t.getUint32(i,!0)));return r.__externref_drop_slice(n,e),s}function le(n,e){return n=n>>>0,y().subarray(n/1,n/1+e)}let C=null;function ne(){return(C===null||C.byteLength===0)&&(C=new BigUint64Array(r.memory.buffer)),C}function we(n,e){const t=e(n.length*8,8)>>>0;return ne().set(n,t/8),a=n.length,t}function A(n,e){const t=e(n.length*1,1)>>>0;return y().set(n,t/1),a=n.length,t}function p(n,e){const t=e(n.length*4,4)>>>0;for(let s=0;s<n.length;s++){const i=m(n[s]);w().setUint32(t+4*s,i,!0)}return a=n.length,t}function de(n,e){return n=n>>>0,ne().subarray(n/8,n/8+e)}function fe(n,e,t){r.closure234_externref_shim(n,e,t)}function pe(n,e,t,s){r.closure258_externref_shim(n,e,t,s)}const L=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_announceerrormessage_free(n>>>0,1));class I{static __wrap(e){e=e>>>0;const t=Object.create(I.prototype);return t.__wbg_ptr=e,L.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,L.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_announceerrormessage_free(e,0)}get errorCode(){const e=r.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get reasonPhrase(){let e,t;try{const s=r.announceerrormessage_reasonPhrase(this.__wbg_ptr);return e=s[0],t=s[1],g(s[0],s[1])}finally{r.__wbindgen_free(e,t,1)}}get trackNamespace(){const e=r.announceerrormessage_trackNamespace(this.__wbg_ptr);var t=S(e[0],e[1]).slice();return r.__wbindgen_free(e[0],e[1]*4,4),t}}const D=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_announcemessage_free(n>>>0,1));class k{static __wrap(e){e=e>>>0;const t=Object.create(k.prototype);return t.__wbg_ptr=e,D.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_announcemessage_free(e,0)}get trackNamespace(){const e=r.announcemessage_trackNamespace(this.__wbg_ptr);var t=S(e[0],e[1]).slice();return r.__wbindgen_free(e[0],e[1]*4,4),t}}const $=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_announceokmessage_free(n>>>0,1));class H{static __wrap(e){e=e>>>0;const t=Object.create(H.prototype);return t.__wbg_ptr=e,$.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,$.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_announceokmessage_free(e,0)}get trackNamespace(){const e=r.announceokmessage_trackNamespace(this.__wbg_ptr);var t=S(e[0],e[1]).slice();return r.__wbindgen_free(e[0],e[1]*4,4),t}}const V=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_moqtclient_free(n>>>0,1));class he{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,V.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_moqtclient_free(e,0)}isConnected(){return r.moqtclient_isConnected(this.__wbg_ptr)!==0}isSubscribed(e){return r.moqtclient_isSubscribed(this.__wbg_ptr,e)!==0}getSubgroupState(e){const t=r.moqtclient_getSubgroupState(this.__wbg_ptr,e);return z.__wrap(t)}sendSetupMessage(e,t){const s=we(e,r.__wbindgen_malloc),i=a;return r.moqtclient_sendSetupMessage(this.__wbg_ptr,s,i,t)}onSetup(e){r.moqtclient_onSetup(this.__wbg_ptr,e)}resetSubgroupState(e){r.moqtclient_resetSubgroupState(this.__wbg_ptr,e)}sendDatagramObject(e,t,s,i,o){const _=A(o,r.__wbindgen_malloc),c=a;return r.moqtclient_sendDatagramObject(this.__wbg_ptr,e,t,s,i,_,c)}getTrackSubscribers(e,t){const s=p(e,r.__wbindgen_malloc),i=a,o=b(t,r.__wbindgen_malloc,r.__wbindgen_realloc),_=a,c=r.moqtclient_getTrackSubscribers(this.__wbg_ptr,s,i,o,_);var u=de(c[0],c[1]).slice();return r.__wbindgen_free(c[0],c[1]*8,8),u}sendAnnounceMessage(e,t){const s=p(e,r.__wbindgen_malloc),i=a,o=b(t,r.__wbindgen_malloc,r.__wbindgen_realloc),_=a;return r.moqtclient_sendAnnounceMessage(this.__wbg_ptr,s,i,o,_)}onAnnounce(e){r.moqtclient_onAnnounce(this.__wbg_ptr,e)}sendSubscribeMessage(e,t,s,i,o,_,c,u,O,M,R){const q=p(s,r.__wbindgen_malloc),se=a,ie=b(i,r.__wbindgen_malloc,r.__wbindgen_realloc),oe=a,_e=b(R,r.__wbindgen_malloc,r.__wbindgen_realloc),ce=a;return r.moqtclient_sendSubscribeMessage(this.__wbg_ptr,e,t,q,se,ie,oe,o,_,c,u,O,M,_e,ce)}onSubscribe(e){r.moqtclient_onSubscribe(this.__wbg_ptr,e)}sendUnannounceMessage(e){const t=p(e,r.__wbindgen_malloc),s=a;return r.moqtclient_sendUnannounceMessage(this.__wbg_ptr,t,s)}sendAnnounceOkMessage(e){const t=p(e,r.__wbindgen_malloc),s=a;return r.moqtclient_sendAnnounceOkMessage(this.__wbg_ptr,t,s)}sendUnsubscribeMessage(e){return r.moqtclient_sendUnsubscribeMessage(this.__wbg_ptr,e)}onUnsubscribe(e){r.moqtclient_onUnsubscribe(this.__wbg_ptr,e)}incrementSubgroupObject(e){r.moqtclient_incrementSubgroupObject(this.__wbg_ptr,e)}markSubgroupHeaderSent(e){r.moqtclient_markSubgroupHeaderSent(this.__wbg_ptr,e)}sendSubscribeOkMessage(e,t,s,i){const o=b(s,r.__wbindgen_malloc,r.__wbindgen_realloc),_=a,c=b(i,r.__wbindgen_malloc,r.__wbindgen_realloc),u=a;return r.moqtclient_sendSubscribeOkMessage(this.__wbg_ptr,e,t,o,_,c,u)}array_buffer_sample_method(e){const t=A(e,r.__wbindgen_malloc),s=a;r.moqtclient_array_buffer_sample_method(this.__wbg_ptr,t,s)}sendDatagramObjectStatus(e,t,s,i,o){return r.moqtclient_sendDatagramObjectStatus(this.__wbg_ptr,e,t,s,i,o)}sendSubgroupStreamObject(e,t,s,i,o,_){const c=A(_,r.__wbindgen_malloc),u=a;return r.moqtclient_sendSubgroupStreamObject(this.__wbg_ptr,e,t,s,i,h(o)?16777215:o,c,u)}sendSubscribeErrorMessage(e,t,s){const i=b(s,r.__wbindgen_malloc,r.__wbindgen_realloc),o=a;return r.moqtclient_sendSubscribeErrorMessage(this.__wbg_ptr,e,t,i,o)}onDatagramObject(e){r.moqtclient_onDatagramObject(this.__wbg_ptr,e)}onAnnounceResponse(e){r.moqtclient_onAnnounceResponse(this.__wbg_ptr,e)}onConnectionClosed(e){r.moqtclient_onConnectionClosed(this.__wbg_ptr,e)}onSubscribeResponse(e){r.moqtclient_onSubscribeResponse(this.__wbg_ptr,e)}sendSubscribeAnnouncesMessage(e,t){const s=p(e,r.__wbindgen_malloc),i=a,o=b(t,r.__wbindgen_malloc,r.__wbindgen_realloc),_=a;return r.moqtclient_sendSubscribeAnnouncesMessage(this.__wbg_ptr,s,i,o,_)}sendSubgroupStreamHeaderMessage(e,t,s,i){return r.moqtclient_sendSubgroupStreamHeaderMessage(this.__wbg_ptr,e,t,s,i)}onDatagramObjectStatus(e){r.moqtclient_onDatagramObjectStatus(this.__wbg_ptr,e)}onSubgroupStreamHeader(e){r.moqtclient_onSubgroupStreamHeader(this.__wbg_ptr,e)}onSubgroupStreamObject(e){r.moqtclient_onSubgroupStreamObject(this.__wbg_ptr,e)}constructor(e){const t=b(e,r.__wbindgen_malloc,r.__wbindgen_realloc),s=a,i=r.moqtclient_new(t,s);return this.__wbg_ptr=i>>>0,V.register(this,this.__wbg_ptr,this),this}url(){return r.moqtclient_url(this.__wbg_ptr)}onSubscribeAnnouncesResponse(e){r.moqtclient_onSubscribeAnnouncesResponse(this.__wbg_ptr,e)}close(){return r.moqtclient_close(this.__wbg_ptr)}start(){return r.moqtclient_start(this.__wbg_ptr)}get id(){const e=r.__wbg_get_moqtclient_id(this.__wbg_ptr);return BigInt.asUintN(64,e)}set id(e){r.__wbg_set_moqtclient_id(this.__wbg_ptr,e)}}const G=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_serversetupmessage_free(n>>>0,1));class U{static __wrap(e){e=e>>>0;const t=Object.create(U.prototype);return t.__wbg_ptr=e,G.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,G.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_serversetupmessage_free(e,0)}get version(){return r.serversetupmessage_version(this.__wbg_ptr)>>>0}}const Q=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_subgroupstate_free(n>>>0,1));class z{static __wrap(e){e=e>>>0;const t=Object.create(z.prototype);return t.__wbg_ptr=e,Q.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Q.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_subgroupstate_free(e,0)}get headerSent(){return r.subgroupstate_headerSent(this.__wbg_ptr)!==0}get subgroupId(){const e=r.subgroupstate_subgroupId(this.__wbg_ptr);return BigInt.asUintN(64,e)}get trackAlias(){const e=r.subgroupstate_trackAlias(this.__wbg_ptr);return BigInt.asUintN(64,e)}get groupId(){const e=r.subgroupstate_groupId(this.__wbg_ptr);return BigInt.asUintN(64,e)}get objectId(){const e=r.subgroupstate_objectId(this.__wbg_ptr);return BigInt.asUintN(64,e)}}const J=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_subgroupstreamobjectmessage_free(n>>>0,1));class x{static __wrap(e){e=e>>>0;const t=Object.create(x.prototype);return t.__wbg_ptr=e,J.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,J.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_subgroupstreamobjectmessage_free(e,0)}get objectStatus(){const e=r.subgroupstreamobjectmessage_objectStatus(this.__wbg_ptr);return e===16777215?void 0:e}get objectPayload(){const e=r.subgroupstreamobjectmessage_objectPayload(this.__wbg_ptr);var t=le(e[0],e[1]).slice();return r.__wbindgen_free(e[0],e[1]*1,1),t}get objectPayloadLength(){return r.subgroupstreamobjectmessage_objectPayloadLength(this.__wbg_ptr)>>>0}get objectId(){const e=r.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}}const K=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_subscribeannounceserrormessage_free(n>>>0,1));class N{static __wrap(e){e=e>>>0;const t=Object.create(N.prototype);return t.__wbg_ptr=e,K.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,K.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_subscribeannounceserrormessage_free(e,0)}get errorCode(){const e=r.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get reasonPhrase(){let e,t;try{const s=r.subscribeannounceserrormessage_reasonPhrase(this.__wbg_ptr);return e=s[0],t=s[1],g(s[0],s[1])}finally{r.__wbindgen_free(e,t,1)}}get trackNamespacePrefix(){const e=r.subscribeannounceserrormessage_trackNamespacePrefix(this.__wbg_ptr);var t=S(e[0],e[1]).slice();return r.__wbindgen_free(e[0],e[1]*4,4),t}}const X=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_subscribeannouncesokmessage_free(n>>>0,1));class T{static __wrap(e){e=e>>>0;const t=Object.create(T.prototype);return t.__wbg_ptr=e,X.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,X.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_subscribeannouncesokmessage_free(e,0)}get trackNamespacePrefix(){const e=r.subscribeannouncesokmessage_trackNamespacePrefix(this.__wbg_ptr);var t=S(e[0],e[1]).slice();return r.__wbindgen_free(e[0],e[1]*4,4),t}}const Y=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_subscribeerrormessage_free(n>>>0,1));class E{static __wrap(e){e=e>>>0;const t=Object.create(E.prototype);return t.__wbg_ptr=e,Y.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Y.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_subscribeerrormessage_free(e,0)}get errorCode(){const e=r.subscribeerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get subscribeId(){const e=r.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get reasonPhrase(){let e,t;try{const s=r.subscribeerrormessage_reasonPhrase(this.__wbg_ptr);return e=s[0],t=s[1],g(s[0],s[1])}finally{r.__wbindgen_free(e,t,1)}}}const Z=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_subscribemessage_free(n>>>0,1));class B{static __wrap(e){e=e>>>0;const t=Object.create(B.prototype);return t.__wbg_ptr=e,Z.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Z.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_subscribemessage_free(e,0)}get trackName(){let e,t;try{const s=r.subscribemessage_trackName(this.__wbg_ptr);return e=s[0],t=s[1],g(s[0],s[1])}finally{r.__wbindgen_free(e,t,1)}}get trackAlias(){const e=r.subscribeerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get subscribeId(){const e=r.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get trackNamespace(){const e=r.subscribemessage_trackNamespace(this.__wbg_ptr);var t=S(e[0],e[1]).slice();return r.__wbindgen_free(e[0],e[1]*4,4),t}}const ee=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>r.__wbg_subscribeokmessage_free(n>>>0,1));class P{static __wrap(e){e=e>>>0;const t=Object.create(P.prototype);return t.__wbg_ptr=e,ee.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,ee.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_subscribeokmessage_free(e,0)}get subscribeId(){const e=r.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}}async function me(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(s){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",s);else throw s}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function ye(){const n={};return n.wbg={},n.wbg.__wbg_announceerrormessage_new=function(e){return I.__wrap(e)},n.wbg.__wbg_announcemessage_new=function(e){return k.__wrap(e)},n.wbg.__wbg_announceokmessage_new=function(e){return H.__wrap(e)},n.wbg.__wbg_buffer_609cc3eee51ed158=function(e){return e.buffer},n.wbg.__wbg_call_672a4d21634d4a24=function(){return d(function(e,t){return e.call(t)},arguments)},n.wbg.__wbg_call_7cccdd69e0791ae2=function(){return d(function(e,t,s){return e.call(t,s)},arguments)},n.wbg.__wbg_call_b8adc8b1d0a0d8eb=function(){return d(function(e,t,s,i,o){return e.call(t,s,i,o)},arguments)},n.wbg.__wbg_cancel_8a308660caa6cadf=function(e){return e.cancel()},n.wbg.__wbg_close_8f541d38492caa4f=function(e){e.close()},n.wbg.__wbg_closed_efe2eab65ced237b=function(e){return e.closed},n.wbg.__wbg_createBidirectionalStream_1864e38d99fe2f41=function(e){return e.createBidirectionalStream()},n.wbg.__wbg_createUnidirectionalStream_ec8004ca7d0df7c1=function(e){return e.createUnidirectionalStream()},n.wbg.__wbg_datagrams_80404f8c7ecfbd83=function(e){return e.datagrams},n.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,t){let s,i;try{s=e,i=t,console.error(g(e,t))}finally{r.__wbindgen_free(s,i,1)}},n.wbg.__wbg_getWriter_6ce182d0adc3f96b=function(){return d(function(e){return e.getWriter()},arguments)},n.wbg.__wbg_get_67b2ba62fc30de12=function(){return d(function(e,t){return Reflect.get(e,t)},arguments)},n.wbg.__wbg_incomingUnidirectionalStreams_0b1b3186de04bf1c=function(e){return e.incomingUnidirectionalStreams},n.wbg.__wbg_length_a446193dc22c12f8=function(e){return e.length},n.wbg.__wbg_log_3ed34de8bce57d50=function(e,t){console.log(g(e,t))},n.wbg.__wbg_new_22a36452a23e0e6f=function(){return d(function(e){return new ReadableStreamDefaultReader(e)},arguments)},n.wbg.__wbg_new_23a2665fac83c611=function(e,t){try{var s={a:e,b:t},i=(_,c)=>{const u=s.a;s.a=0;try{return pe(u,s.b,_,c)}finally{s.a=u}};return new Promise(i)}finally{s.a=s.b=0}},n.wbg.__wbg_new_405e22f390576ce2=function(){return new Object},n.wbg.__wbg_new_648b5fed08659269=function(){return d(function(e,t){return new WebTransport(g(e,t))},arguments)},n.wbg.__wbg_new_78feb108b6472713=function(){return new Array},n.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},n.wbg.__wbg_new_a12002a7f91c75be=function(e){return new Uint8Array(e)},n.wbg.__wbg_new_c68d7209be747379=function(e,t){return new Error(g(e,t))},n.wbg.__wbg_newnoargs_105ed471475aaf50=function(e,t){return new Function(g(e,t))},n.wbg.__wbg_newwithbyteoffsetandlength_d97e637ebe145a9a=function(e,t,s){return new Uint8Array(e,t>>>0,s>>>0)},n.wbg.__wbg_newwithlength_a381634e90c276d4=function(e){return new Uint8Array(e>>>0)},n.wbg.__wbg_queueMicrotask_97d92b4fcc8a61c5=function(e){queueMicrotask(e)},n.wbg.__wbg_queueMicrotask_d3219def82552485=function(e){return e.queueMicrotask},n.wbg.__wbg_read_a2434af1186cb56c=function(e){return e.read()},n.wbg.__wbg_readable_27169433a44cf102=function(e){return e.readable},n.wbg.__wbg_readable_3e4ffb2da948911f=function(e){return e.readable},n.wbg.__wbg_ready_b8a89d043508e00b=function(e){return e.ready},n.wbg.__wbg_resolve_4851785c9c5f573d=function(e){return Promise.resolve(e)},n.wbg.__wbg_serversetupmessage_new=function(e){return U.__wrap(e)},n.wbg.__wbg_set_37837023f3d740e8=function(e,t,s){e[t>>>0]=s},n.wbg.__wbg_set_3f1d0b984ed272ed=function(e,t,s){e[t]=s},n.wbg.__wbg_set_65595bdd868b3009=function(e,t,s){e.set(t,s>>>0)},n.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,t){const s=t.stack,i=b(s,r.__wbindgen_malloc,r.__wbindgen_realloc),o=a;w().setInt32(e+4*1,o,!0),w().setInt32(e+4*0,i,!0)},n.wbg.__wbg_static_accessor_GLOBAL_88a902d13a557d07=function(){const e=typeof global>"u"?null:global;return h(e)?0:m(e)},n.wbg.__wbg_static_accessor_GLOBAL_THIS_56578be7e9f832b0=function(){const e=typeof globalThis>"u"?null:globalThis;return h(e)?0:m(e)},n.wbg.__wbg_static_accessor_SELF_37c5d418e4bf5819=function(){const e=typeof self>"u"?null:self;return h(e)?0:m(e)},n.wbg.__wbg_static_accessor_WINDOW_5de37043a91a9c40=function(){const e=typeof window>"u"?null:window;return h(e)?0:m(e)},n.wbg.__wbg_subgroupstreamobjectmessage_new=function(e){return x.__wrap(e)},n.wbg.__wbg_subscribeannounceserrormessage_new=function(e){return N.__wrap(e)},n.wbg.__wbg_subscribeannouncesokmessage_new=function(e){return T.__wrap(e)},n.wbg.__wbg_subscribeerrormessage_new=function(e){return E.__wrap(e)},n.wbg.__wbg_subscribemessage_new=function(e){return B.__wrap(e)},n.wbg.__wbg_subscribeokmessage_new=function(e){return P.__wrap(e)},n.wbg.__wbg_then_44b73946d2fb3e7d=function(e,t){return e.then(t)},n.wbg.__wbg_then_48b406749878a531=function(e,t,s){return e.then(t,s)},n.wbg.__wbg_valueOf_7392193dd78c6b97=function(e){return e.valueOf()},n.wbg.__wbg_writable_3aaf0c2a3e6b2779=function(e){return e.writable},n.wbg.__wbg_writable_f20a11ad767ecbd4=function(e){return e.writable},n.wbg.__wbg_write_311434e30ee214e5=function(e,t){return e.write(t)},n.wbg.__wbindgen_as_number=function(e){return+e},n.wbg.__wbindgen_bigint_from_u64=function(e){return BigInt.asUintN(64,e)},n.wbg.__wbindgen_cb_drop=function(e){const t=e.original;return t.cnt--==1?(t.a=0,!0):!1},n.wbg.__wbindgen_closure_wrapper601=function(e,t,s){return ge(e,t,235,fe)},n.wbg.__wbindgen_debug_string=function(e,t){const s=v(t),i=b(s,r.__wbindgen_malloc,r.__wbindgen_realloc),o=a;w().setInt32(e+4*1,o,!0),w().setInt32(e+4*0,i,!0)},n.wbg.__wbindgen_error_new=function(e,t){return new Error(g(e,t))},n.wbg.__wbindgen_init_externref_table=function(){const e=r.__wbindgen_export_2,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},n.wbg.__wbindgen_is_function=function(e){return typeof e=="function"},n.wbg.__wbindgen_is_undefined=function(e){return e===void 0},n.wbg.__wbindgen_memory=function(){return r.memory},n.wbg.__wbindgen_number_new=function(e){return e},n.wbg.__wbindgen_string_get=function(e,t){const s=t,i=typeof s=="string"?s:void 0;var o=h(i)?0:b(i,r.__wbindgen_malloc,r.__wbindgen_realloc),_=a;w().setInt32(e+4*1,_,!0),w().setInt32(e+4*0,o,!0)},n.wbg.__wbindgen_string_new=function(e,t){return g(e,t)},n.wbg.__wbindgen_throw=function(e,t){throw new Error(g(e,t))},n}function Se(n,e){return r=n.exports,re.__wbindgen_wasm_module=e,C=null,f=null,j=null,r.__wbindgen_start(),r}async function re(n){if(r!==void 0)return r;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module_or_path:n}=n:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof n>"u"&&(n=new URL("/moq-wasm/assets/moqt_client_sample_bg-a754dbc8.wasm",self.location));const e=ye();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:s}=await me(await n,e);return Se(t,s)}class Oe{constructor(){l(this,"subgroupObjectHandlers",new Map)}setSubgroupObjectHandler(e,t){this.subgroupObjectHandlers.set(e,t)}getSubgroupObjectHandler(e){return this.subgroupObjectHandlers.get(e)}deleteSubgroupObjectHandler(e){this.subgroupObjectHandlers.delete(e)}clearHandlers(){this.subgroupObjectHandlers.clear()}}class Me{constructor(e){l(this,"client",null);l(this,"serverSetupResolve",null);l(this,"onAnnounceHandler",null);l(this,"onSubscribeResponseHandler",null);l(this,"onConnectionClosedHandler",null);l(this,"incomingSubscribeHandler",null);l(this,"onServerSetupHandler",null);l(this,"subscriptionState");this.subscriptionState=e??new Oe}async connect(e,t={}){if(!this.getConnectionStatus())try{if(await re(),this.client=new he(e),await this.client.start(),this.setupCallbacks(),t.sendSetup===!1){this.serverSetupResolve=null;return}const s=new Promise(_=>{this.serverSetupResolve=_}),i=t.versions??new BigUint64Array([0xff00000an]),o=t.maxSubscribeId??100n;await this.client.sendSetupMessage(i,o),await s}catch(s){throw this.cleanupClient(),console.error("Failed to connect MoQT client:",s),s}}async sendSetupMessage(e,t){const s=this.requireConnectedClient(),i=new Promise(o=>{this.serverSetupResolve=o});await s.sendSetupMessage(e,t),await i}async disconnect(){if(this.client)try{await this.client.close()}finally{this.cleanupClient()}}getConnectionStatus(){return!!this.client&&this.client.isConnected()}getRawClient(){return this.client}setOnConnectionClosedHandler(e){this.onConnectionClosedHandler=e}setOnServerSetupHandler(e){this.onServerSetupHandler=e}setOnAnnounceHandler(e){this.onAnnounceHandler=e}setOnSubscribeResponseHandler(e){this.onSubscribeResponseHandler=e}setOnIncomingSubscribeHandler(e){this.incomingSubscribeHandler=e}setOnSubgroupObjectHandler(e,t){this.subscriptionState.setSubgroupObjectHandler(e,t)}clearSubgroupObjectHandler(e){this.subscriptionState.deleteSubgroupObjectHandler(e)}clearSubgroupObjectHandlers(){this.subscriptionState.clearHandlers()}async announce(e,t){await this.requireConnectedClient().sendAnnounceMessage(e,t)}async subscribeAnnounces(e,t){await this.requireConnectedClient().sendSubscribeAnnouncesMessage(e,t)}async subscribe(e,t,s,i,o){const _=this.requireConnectedClient();if(_.isSubscribed(e))return;const c=0,u=0,O=1,M=0n,R=0n,q=0n;await _.sendSubscribeMessage(e,t,s,i,c,u,O,M,R,q,o)}async sendSubgroupTextForTrack(e,t,s){const o=this.requireConnectedClient().getTrackSubscribers(e,t);if(!o.length){console.warn(`No subscribers registered for track ${e.join("/")}/${t}`);return}for(const _ of o)await this.sendSubgroupTextForAlias(_,s)}setupCallbacks(){this.client&&(this.client.onSetup(e=>{var t;this.serverSetupResolve&&(this.serverSetupResolve(),this.serverSetupResolve=null),(t=this.onServerSetupHandler)==null||t.call(this,e)}),this.client.onAnnounce(e=>{var t;(t=this.onAnnounceHandler)==null||t.call(this,e)}),this.client.onAnnounceResponse(e=>{}),this.client.onSubscribe(async(e,t,s)=>{await(this.incomingSubscribeHandler??je)({subscribe:e,isSuccess:t,code:s,respondOk:(o,_,c)=>this.requireConnectedClient().sendSubscribeOkMessage(e.subscribeId,o,_,c),respondError:(o,_)=>this.requireConnectedClient().sendSubscribeErrorMessage(e.subscribeId,o,_)})}),this.client.onSubscribeResponse(e=>{var t;(t=this.onSubscribeResponseHandler)==null||t.call(this,e)}),this.client.onSubscribeAnnouncesResponse(e=>{}),this.client.onSubgroupStreamHeader(e=>{}),this.client.onSubgroupStreamObject((e,t,s)=>{const i=this.subscriptionState.getSubgroupObjectHandler(e);i==null||i(t,s)}),this.client.onConnectionClosed(()=>this.handleConnectionClosed()))}async sendSubgroupTextForAlias(e,t){const s=this.requireConnectedClient(),i=s.getSubgroupState(e),o=0;i.headerSent||(await s.sendSubgroupStreamHeaderMessage(e,i.groupId,i.subgroupId,o),s.markSubgroupHeaderSent(e));const _=new TextEncoder().encode(t);await s.sendSubgroupStreamObject(e,i.groupId,i.subgroupId,i.objectId,void 0,_),s.incrementSubgroupObject(e)}handleConnectionClosed(){var e;this.cleanupClient(),(e=this.onConnectionClosedHandler)==null||e.call(this)}cleanupClient(){this.client&&(this.client.free(),this.client=null),this.subscriptionState.clearHandlers(),this.serverSetupResolve=null}requireConnectedClient(){if(!this.client||!this.client.isConnected())throw new Error("MOQT client is not connected");return this.client}}const je=async n=>{if(n.isSuccess){await n.respondOk(0n,"secret","subgroup");return}await n.respondError(BigInt(n.code),"Subscription validation failed")};export{Me as M};
