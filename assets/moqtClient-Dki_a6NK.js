(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const _ of i.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&r(_)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();let s,a=0,S=null;function h(){return(S===null||S.byteLength===0)&&(S=new Uint8Array(s.memory.buffer)),S}const C=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},ae=typeof C.encodeInto=="function"?function(n,e){return C.encodeInto(n,e)}:function(n,e){const t=C.encode(n);return e.set(t),{read:n.length,written:t.length}};function g(n,e,t){if(t===void 0){const c=C.encode(n),u=e(c.length,1)>>>0;return h().subarray(u,u+c.length).set(c),a=c.length,u}let r=n.length,o=e(r,1)>>>0;const i=h();let _=0;for(;_<r;_++){const c=n.charCodeAt(_);if(c>127)break;i[o+_]=c}if(_!==r){_!==0&&(n=n.slice(_)),o=t(o,r,r=_+n.length*3,1)>>>0;const c=h().subarray(o+_,o+r),u=ae(n,c);_+=u.written,o=t(o,r,_,1)>>>0}return a=_,o}let f=null;function b(){return(f===null||f.buffer.detached===!0||f.buffer.detached===void 0&&f.buffer!==s.memory.buffer)&&(f=new DataView(s.memory.buffer)),f}function m(n){const e=s.__externref_table_alloc();return s.__wbindgen_export_4.set(e,n),e}function d(n,e){try{return n.apply(this,e)}catch(t){const r=m(t);s.__wbindgen_exn_store(r)}}const te=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&te.decode();function l(n,e){return n=n>>>0,te.decode(h().subarray(n,n+e))}function w(n){return n==null}const P=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>{s.__wbindgen_export_6.get(n.dtor)(n.a,n.b)});function ue(n,e,t,r){const o={a:n,b:e,cnt:1,dtor:t},i=(..._)=>{o.cnt++;const c=o.a;o.a=0;try{return r(c,o.b,..._)}finally{--o.cnt===0?(s.__wbindgen_export_6.get(o.dtor)(c,o.b),P.unregister(o)):o.a=c}};return i.original=o,P.register(i,o,o),i}function M(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const o=n.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=n.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(n)){const o=n.length;let i="[";o>0&&(i+=M(n[0]));for(let _=1;_<o;_++)i+=", "+M(n[_]);return i+="]",i}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let r;if(t&&t.length>1)r=t[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}function y(n,e){n=n>>>0;const t=b(),r=[];for(let o=n;o<n+4*e;o+=4)r.push(s.__wbindgen_export_4.get(t.getUint32(o,!0)));return s.__externref_drop_slice(n,e),r}function be(n,e){return n=n>>>0,h().subarray(n/1,n/1+e)}let O=null;function ne(){return(O===null||O.byteLength===0)&&(O=new BigUint64Array(s.memory.buffer)),O}function ge(n,e){const t=e(n.length*8,8)>>>0;return ne().set(n,t/8),a=n.length,t}function F(n,e){const t=e(n.length*1,1)>>>0;return h().set(n,t/1),a=n.length,t}function p(n,e){const t=e(n.length*4,4)>>>0;for(let r=0;r<n.length;r++){const o=m(n[r]);b().setUint32(t+4*r,o,!0)}return a=n.length,t}function le(n,e){return n=n>>>0,ne().subarray(n/8,n/8+e)}function W(n){const e=s.__wbindgen_export_4.get(n);return s.__externref_table_dealloc(n),e}function je(n){const e=g(n,s.__wbindgen_malloc,s.__wbindgen_realloc),t=a,r=s.parse_msf_catalog_json(e,t);if(r[2])throw W(r[1]);return W(r[0])}function we(n,e,t){s.closure244_externref_shim(n,e,t)}function de(n,e,t,r){s.closure268_externref_shim(n,e,t,r)}const L=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_announceerrormessage_free(n>>>0,1));class A{static __wrap(e){e=e>>>0;const t=Object.create(A.prototype);return t.__wbg_ptr=e,L.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,L.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_announceerrormessage_free(e,0)}get errorCode(){const e=s.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get reasonPhrase(){let e,t;try{const r=s.announceerrormessage_reasonPhrase(this.__wbg_ptr);return e=r[0],t=r[1],l(r[0],r[1])}finally{s.__wbindgen_free(e,t,1)}}get trackNamespace(){const e=s.announceerrormessage_trackNamespace(this.__wbg_ptr);var t=y(e[0],e[1]).slice();return s.__wbindgen_free(e[0],e[1]*4,4),t}}const D=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_announcemessage_free(n>>>0,1));class q{static __wrap(e){e=e>>>0;const t=Object.create(q.prototype);return t.__wbg_ptr=e,D.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_announcemessage_free(e,0)}get trackNamespace(){const e=s.announcemessage_trackNamespace(this.__wbg_ptr);var t=y(e[0],e[1]).slice();return s.__wbindgen_free(e[0],e[1]*4,4),t}}const $=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_announceokmessage_free(n>>>0,1));class R{static __wrap(e){e=e>>>0;const t=Object.create(R.prototype);return t.__wbg_ptr=e,$.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,$.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_announceokmessage_free(e,0)}get trackNamespace(){const e=s.announceokmessage_trackNamespace(this.__wbg_ptr);var t=y(e[0],e[1]).slice();return s.__wbindgen_free(e[0],e[1]*4,4),t}}const G=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_moqtclient_free(n>>>0,1));class fe{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,G.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_moqtclient_free(e,0)}isConnected(){return s.moqtclient_isConnected(this.__wbg_ptr)!==0}isSubscribed(e){return s.moqtclient_isSubscribed(this.__wbg_ptr,e)!==0}getSubgroupState(e){const t=s.moqtclient_getSubgroupState(this.__wbg_ptr,e);return I.__wrap(t)}sendSetupMessage(e,t){const r=ge(e,s.__wbindgen_malloc),o=a;return s.moqtclient_sendSetupMessage(this.__wbg_ptr,r,o,t)}onSetup(e){s.moqtclient_onSetup(this.__wbg_ptr,e)}resetSubgroupState(e){s.moqtclient_resetSubgroupState(this.__wbg_ptr,e)}sendDatagramObject(e,t,r,o,i){const _=F(i,s.__wbindgen_malloc),c=a;return s.moqtclient_sendDatagramObject(this.__wbg_ptr,e,t,r,o,_,c)}getTrackSubscribers(e,t){const r=p(e,s.__wbindgen_malloc),o=a,i=g(t,s.__wbindgen_malloc,s.__wbindgen_realloc),_=a,c=s.moqtclient_getTrackSubscribers(this.__wbg_ptr,r,o,i,_);var u=le(c[0],c[1]).slice();return s.__wbindgen_free(c[0],c[1]*8,8),u}sendAnnounceMessage(e,t){const r=p(e,s.__wbindgen_malloc),o=a,i=g(t,s.__wbindgen_malloc,s.__wbindgen_realloc),_=a;return s.moqtclient_sendAnnounceMessage(this.__wbg_ptr,r,o,i,_)}onAnnounce(e){s.moqtclient_onAnnounce(this.__wbg_ptr,e)}sendSubscribeMessage(e,t,r,o,i,_,c,u,j,N,B){const E=p(r,s.__wbindgen_malloc),se=a,oe=g(o,s.__wbindgen_malloc,s.__wbindgen_realloc),ie=a,_e=g(B,s.__wbindgen_malloc,s.__wbindgen_realloc),ce=a;return s.moqtclient_sendSubscribeMessage(this.__wbg_ptr,e,t,E,se,oe,ie,i,_,c,u,j,N,_e,ce)}onSubscribe(e){s.moqtclient_onSubscribe(this.__wbg_ptr,e)}sendUnannounceMessage(e){const t=p(e,s.__wbindgen_malloc),r=a;return s.moqtclient_sendUnannounceMessage(this.__wbg_ptr,t,r)}sendAnnounceOkMessage(e){const t=p(e,s.__wbindgen_malloc),r=a;return s.moqtclient_sendAnnounceOkMessage(this.__wbg_ptr,t,r)}sendUnsubscribeMessage(e){return s.moqtclient_sendUnsubscribeMessage(this.__wbg_ptr,e)}onUnsubscribe(e){s.moqtclient_onUnsubscribe(this.__wbg_ptr,e)}incrementSubgroupObject(e){s.moqtclient_incrementSubgroupObject(this.__wbg_ptr,e)}markSubgroupHeaderSent(e){s.moqtclient_markSubgroupHeaderSent(this.__wbg_ptr,e)}sendSubscribeOkMessage(e,t,r,o){const i=g(r,s.__wbindgen_malloc,s.__wbindgen_realloc),_=a,c=g(o,s.__wbindgen_malloc,s.__wbindgen_realloc),u=a;return s.moqtclient_sendSubscribeOkMessage(this.__wbg_ptr,e,t,i,_,c,u)}array_buffer_sample_method(e){const t=F(e,s.__wbindgen_malloc),r=a;s.moqtclient_array_buffer_sample_method(this.__wbg_ptr,t,r)}sendDatagramObjectStatus(e,t,r,o,i){return s.moqtclient_sendDatagramObjectStatus(this.__wbg_ptr,e,t,r,o,i)}sendSubgroupStreamObject(e,t,r,o,i,_){const c=F(_,s.__wbindgen_malloc),u=a;return s.moqtclient_sendSubgroupStreamObject(this.__wbg_ptr,e,t,r,o,w(i)?16777215:i,c,u)}sendSubscribeErrorMessage(e,t,r){const o=g(r,s.__wbindgen_malloc,s.__wbindgen_realloc),i=a;return s.moqtclient_sendSubscribeErrorMessage(this.__wbg_ptr,e,t,o,i)}onDatagramObject(e){s.moqtclient_onDatagramObject(this.__wbg_ptr,e)}onAnnounceResponse(e){s.moqtclient_onAnnounceResponse(this.__wbg_ptr,e)}onConnectionClosed(e){s.moqtclient_onConnectionClosed(this.__wbg_ptr,e)}onSubscribeResponse(e){s.moqtclient_onSubscribeResponse(this.__wbg_ptr,e)}sendSubscribeAnnouncesMessage(e,t){const r=p(e,s.__wbindgen_malloc),o=a,i=g(t,s.__wbindgen_malloc,s.__wbindgen_realloc),_=a;return s.moqtclient_sendSubscribeAnnouncesMessage(this.__wbg_ptr,r,o,i,_)}sendSubgroupStreamHeaderMessage(e,t,r,o){return s.moqtclient_sendSubgroupStreamHeaderMessage(this.__wbg_ptr,e,t,r,o)}onDatagramObjectStatus(e){s.moqtclient_onDatagramObjectStatus(this.__wbg_ptr,e)}onSubgroupStreamHeader(e){s.moqtclient_onSubgroupStreamHeader(this.__wbg_ptr,e)}onSubgroupStreamObject(e){s.moqtclient_onSubgroupStreamObject(this.__wbg_ptr,e)}constructor(e){const t=g(e,s.__wbindgen_malloc,s.__wbindgen_realloc),r=a,o=s.moqtclient_new(t,r);return this.__wbg_ptr=o>>>0,G.register(this,this.__wbg_ptr,this),this}url(){return s.moqtclient_url(this.__wbg_ptr)}onSubscribeAnnouncesResponse(e){s.moqtclient_onSubscribeAnnouncesResponse(this.__wbg_ptr,e)}close(){return s.moqtclient_close(this.__wbg_ptr)}start(){return s.moqtclient_start(this.__wbg_ptr)}get id(){const e=s.__wbg_get_moqtclient_id(this.__wbg_ptr);return BigInt.asUintN(64,e)}set id(e){s.__wbg_set_moqtclient_id(this.__wbg_ptr,e)}}const V=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_serversetupmessage_free(n>>>0,1));class v{static __wrap(e){e=e>>>0;const t=Object.create(v.prototype);return t.__wbg_ptr=e,V.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,V.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_serversetupmessage_free(e,0)}get version(){return s.serversetupmessage_version(this.__wbg_ptr)>>>0}}const Q=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_subgroupstate_free(n>>>0,1));class I{static __wrap(e){e=e>>>0;const t=Object.create(I.prototype);return t.__wbg_ptr=e,Q.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Q.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_subgroupstate_free(e,0)}get headerSent(){return s.subgroupstate_headerSent(this.__wbg_ptr)!==0}get subgroupId(){const e=s.subgroupstate_subgroupId(this.__wbg_ptr);return BigInt.asUintN(64,e)}get trackAlias(){const e=s.subgroupstate_trackAlias(this.__wbg_ptr);return BigInt.asUintN(64,e)}get groupId(){const e=s.subgroupstate_groupId(this.__wbg_ptr);return BigInt.asUintN(64,e)}get objectId(){const e=s.subgroupstate_objectId(this.__wbg_ptr);return BigInt.asUintN(64,e)}}const J=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_subgroupstreamobjectmessage_free(n>>>0,1));class k{static __wrap(e){e=e>>>0;const t=Object.create(k.prototype);return t.__wbg_ptr=e,J.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,J.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_subgroupstreamobjectmessage_free(e,0)}get objectStatus(){const e=s.subgroupstreamobjectmessage_objectStatus(this.__wbg_ptr);return e===16777215?void 0:e}get objectPayload(){const e=s.subgroupstreamobjectmessage_objectPayload(this.__wbg_ptr);var t=be(e[0],e[1]).slice();return s.__wbindgen_free(e[0],e[1]*1,1),t}get objectPayloadLength(){return s.subgroupstreamobjectmessage_objectPayloadLength(this.__wbg_ptr)>>>0}get objectId(){const e=s.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}}const K=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_subscribeannounceserrormessage_free(n>>>0,1));class H{static __wrap(e){e=e>>>0;const t=Object.create(H.prototype);return t.__wbg_ptr=e,K.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,K.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_subscribeannounceserrormessage_free(e,0)}get errorCode(){const e=s.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get reasonPhrase(){let e,t;try{const r=s.subscribeannounceserrormessage_reasonPhrase(this.__wbg_ptr);return e=r[0],t=r[1],l(r[0],r[1])}finally{s.__wbindgen_free(e,t,1)}}get trackNamespacePrefix(){const e=s.subscribeannounceserrormessage_trackNamespacePrefix(this.__wbg_ptr);var t=y(e[0],e[1]).slice();return s.__wbindgen_free(e[0],e[1]*4,4),t}}const X=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_subscribeannouncesokmessage_free(n>>>0,1));class U{static __wrap(e){e=e>>>0;const t=Object.create(U.prototype);return t.__wbg_ptr=e,X.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,X.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_subscribeannouncesokmessage_free(e,0)}get trackNamespacePrefix(){const e=s.subscribeannouncesokmessage_trackNamespacePrefix(this.__wbg_ptr);var t=y(e[0],e[1]).slice();return s.__wbindgen_free(e[0],e[1]*4,4),t}}const Y=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_subscribeerrormessage_free(n>>>0,1));class x{static __wrap(e){e=e>>>0;const t=Object.create(x.prototype);return t.__wbg_ptr=e,Y.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Y.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_subscribeerrormessage_free(e,0)}get errorCode(){const e=s.subscribeerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get subscribeId(){const e=s.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get reasonPhrase(){let e,t;try{const r=s.subscribeerrormessage_reasonPhrase(this.__wbg_ptr);return e=r[0],t=r[1],l(r[0],r[1])}finally{s.__wbindgen_free(e,t,1)}}}const Z=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_subscribemessage_free(n>>>0,1));class z{static __wrap(e){e=e>>>0;const t=Object.create(z.prototype);return t.__wbg_ptr=e,Z.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Z.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_subscribemessage_free(e,0)}get trackName(){let e,t;try{const r=s.subscribemessage_trackName(this.__wbg_ptr);return e=r[0],t=r[1],l(r[0],r[1])}finally{s.__wbindgen_free(e,t,1)}}get trackAlias(){const e=s.subscribeerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get subscribeId(){const e=s.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}get trackNamespace(){const e=s.subscribemessage_trackNamespace(this.__wbg_ptr);var t=y(e[0],e[1]).slice();return s.__wbindgen_free(e[0],e[1]*4,4),t}}const ee=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>s.__wbg_subscribeokmessage_free(n>>>0,1));class T{static __wrap(e){e=e>>>0;const t=Object.create(T.prototype);return t.__wbg_ptr=e,ee.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,ee.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_subscribeokmessage_free(e,0)}get subscribeId(){const e=s.announceerrormessage_errorCode(this.__wbg_ptr);return BigInt.asUintN(64,e)}}async function pe(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(r){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function me(){const n={};return n.wbg={},n.wbg.__wbg_String_8f0eb39a4a4c2f66=function(e,t){const r=String(t),o=g(r,s.__wbindgen_malloc,s.__wbindgen_realloc),i=a;b().setInt32(e+4,i,!0),b().setInt32(e+0,o,!0)},n.wbg.__wbg_announceerrormessage_new=function(e){return A.__wrap(e)},n.wbg.__wbg_announcemessage_new=function(e){return q.__wrap(e)},n.wbg.__wbg_announceokmessage_new=function(e){return R.__wrap(e)},n.wbg.__wbg_buffer_609cc3eee51ed158=function(e){return e.buffer},n.wbg.__wbg_call_672a4d21634d4a24=function(){return d(function(e,t){return e.call(t)},arguments)},n.wbg.__wbg_call_7cccdd69e0791ae2=function(){return d(function(e,t,r){return e.call(t,r)},arguments)},n.wbg.__wbg_call_b8adc8b1d0a0d8eb=function(){return d(function(e,t,r,o,i){return e.call(t,r,o,i)},arguments)},n.wbg.__wbg_cancel_8a308660caa6cadf=function(e){return e.cancel()},n.wbg.__wbg_close_8f541d38492caa4f=function(e){e.close()},n.wbg.__wbg_closed_efe2eab65ced237b=function(e){return e.closed},n.wbg.__wbg_createBidirectionalStream_1864e38d99fe2f41=function(e){return e.createBidirectionalStream()},n.wbg.__wbg_createUnidirectionalStream_ec8004ca7d0df7c1=function(e){return e.createUnidirectionalStream()},n.wbg.__wbg_datagrams_80404f8c7ecfbd83=function(e){return e.datagrams},n.wbg.__wbg_done_769e5ede4b31c67b=function(e){return e.done},n.wbg.__wbg_entries_3265d4158b33e5dc=function(e){return Object.entries(e)},n.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,t){let r,o;try{r=e,o=t,console.error(l(e,t))}finally{s.__wbindgen_free(r,o,1)}},n.wbg.__wbg_getWriter_6ce182d0adc3f96b=function(){return d(function(e){return e.getWriter()},arguments)},n.wbg.__wbg_get_67b2ba62fc30de12=function(){return d(function(e,t){return Reflect.get(e,t)},arguments)},n.wbg.__wbg_get_b9b93047fe3cf45b=function(e,t){return e[t>>>0]},n.wbg.__wbg_getwithrefkey_1dc361bd10053bfe=function(e,t){return e[t]},n.wbg.__wbg_incomingUnidirectionalStreams_0b1b3186de04bf1c=function(e){return e.incomingUnidirectionalStreams},n.wbg.__wbg_instanceof_ArrayBuffer_e14585432e3737fc=function(e){let t;try{t=e instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_instanceof_Map_f3469ce2244d2430=function(e){let t;try{t=e instanceof Map}catch{t=!1}return t},n.wbg.__wbg_instanceof_Uint8Array_17156bcf118086a9=function(e){let t;try{t=e instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbg_isArray_a1eab7e0d067391b=function(e){return Array.isArray(e)},n.wbg.__wbg_isSafeInteger_343e2beeeece1bb0=function(e){return Number.isSafeInteger(e)},n.wbg.__wbg_iterator_9a24c88df860dc65=function(){return Symbol.iterator},n.wbg.__wbg_length_a446193dc22c12f8=function(e){return e.length},n.wbg.__wbg_length_e2d2a49132c1b256=function(e){return e.length},n.wbg.__wbg_log_1bcc9edfa6910ea5=function(e,t){console.log(l(e,t))},n.wbg.__wbg_new_22a36452a23e0e6f=function(){return d(function(e){return new ReadableStreamDefaultReader(e)},arguments)},n.wbg.__wbg_new_23a2665fac83c611=function(e,t){try{var r={a:e,b:t},o=(_,c)=>{const u=r.a;r.a=0;try{return de(u,r.b,_,c)}finally{r.a=u}};return new Promise(o)}finally{r.a=r.b=0}},n.wbg.__wbg_new_405e22f390576ce2=function(){return new Object},n.wbg.__wbg_new_648b5fed08659269=function(){return d(function(e,t){return new WebTransport(l(e,t))},arguments)},n.wbg.__wbg_new_78feb108b6472713=function(){return new Array},n.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},n.wbg.__wbg_new_a12002a7f91c75be=function(e){return new Uint8Array(e)},n.wbg.__wbg_new_c68d7209be747379=function(e,t){return new Error(l(e,t))},n.wbg.__wbg_newnoargs_105ed471475aaf50=function(e,t){return new Function(l(e,t))},n.wbg.__wbg_newwithbyteoffsetandlength_d97e637ebe145a9a=function(e,t,r){return new Uint8Array(e,t>>>0,r>>>0)},n.wbg.__wbg_newwithlength_a381634e90c276d4=function(e){return new Uint8Array(e>>>0)},n.wbg.__wbg_next_25feadfc0913fea9=function(e){return e.next},n.wbg.__wbg_next_6574e1a8a62d1055=function(){return d(function(e){return e.next()},arguments)},n.wbg.__wbg_queueMicrotask_97d92b4fcc8a61c5=function(e){queueMicrotask(e)},n.wbg.__wbg_queueMicrotask_d3219def82552485=function(e){return e.queueMicrotask},n.wbg.__wbg_read_a2434af1186cb56c=function(e){return e.read()},n.wbg.__wbg_readable_27169433a44cf102=function(e){return e.readable},n.wbg.__wbg_readable_3e4ffb2da948911f=function(e){return e.readable},n.wbg.__wbg_ready_b8a89d043508e00b=function(e){return e.ready},n.wbg.__wbg_resolve_4851785c9c5f573d=function(e){return Promise.resolve(e)},n.wbg.__wbg_serversetupmessage_new=function(e){return v.__wrap(e)},n.wbg.__wbg_set_37837023f3d740e8=function(e,t,r){e[t>>>0]=r},n.wbg.__wbg_set_3f1d0b984ed272ed=function(e,t,r){e[t]=r},n.wbg.__wbg_set_65595bdd868b3009=function(e,t,r){e.set(t,r>>>0)},n.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,t){const r=t.stack,o=g(r,s.__wbindgen_malloc,s.__wbindgen_realloc),i=a;b().setInt32(e+4,i,!0),b().setInt32(e+0,o,!0)},n.wbg.__wbg_static_accessor_GLOBAL_88a902d13a557d07=function(){const e=typeof global>"u"?null:global;return w(e)?0:m(e)},n.wbg.__wbg_static_accessor_GLOBAL_THIS_56578be7e9f832b0=function(){const e=typeof globalThis>"u"?null:globalThis;return w(e)?0:m(e)},n.wbg.__wbg_static_accessor_SELF_37c5d418e4bf5819=function(){const e=typeof self>"u"?null:self;return w(e)?0:m(e)},n.wbg.__wbg_static_accessor_WINDOW_5de37043a91a9c40=function(){const e=typeof window>"u"?null:window;return w(e)?0:m(e)},n.wbg.__wbg_subgroupstreamobjectmessage_new=function(e){return k.__wrap(e)},n.wbg.__wbg_subscribeannounceserrormessage_new=function(e){return H.__wrap(e)},n.wbg.__wbg_subscribeannouncesokmessage_new=function(e){return U.__wrap(e)},n.wbg.__wbg_subscribeerrormessage_new=function(e){return x.__wrap(e)},n.wbg.__wbg_subscribemessage_new=function(e){return z.__wrap(e)},n.wbg.__wbg_subscribeokmessage_new=function(e){return T.__wrap(e)},n.wbg.__wbg_then_44b73946d2fb3e7d=function(e,t){return e.then(t)},n.wbg.__wbg_then_48b406749878a531=function(e,t,r){return e.then(t,r)},n.wbg.__wbg_valueOf_7392193dd78c6b97=function(e){return e.valueOf()},n.wbg.__wbg_value_cd1ffa7b1ab794f1=function(e){return e.value},n.wbg.__wbg_writable_3aaf0c2a3e6b2779=function(e){return e.writable},n.wbg.__wbg_writable_f20a11ad767ecbd4=function(e){return e.writable},n.wbg.__wbg_write_311434e30ee214e5=function(e,t){return e.write(t)},n.wbg.__wbindgen_as_number=function(e){return+e},n.wbg.__wbindgen_bigint_from_i64=function(e){return e},n.wbg.__wbindgen_bigint_from_u64=function(e){return BigInt.asUintN(64,e)},n.wbg.__wbindgen_bigint_get_as_i64=function(e,t){const r=t,o=typeof r=="bigint"?r:void 0;b().setBigInt64(e+8,w(o)?BigInt(0):o,!0),b().setInt32(e+0,!w(o),!0)},n.wbg.__wbindgen_boolean_get=function(e){const t=e;return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_cb_drop=function(e){const t=e.original;return t.cnt--==1?(t.a=0,!0):!1},n.wbg.__wbindgen_closure_wrapper842=function(e,t,r){return ue(e,t,245,we)},n.wbg.__wbindgen_debug_string=function(e,t){const r=M(t),o=g(r,s.__wbindgen_malloc,s.__wbindgen_realloc),i=a;b().setInt32(e+4,i,!0),b().setInt32(e+0,o,!0)},n.wbg.__wbindgen_error_new=function(e,t){return new Error(l(e,t))},n.wbg.__wbindgen_in=function(e,t){return e in t},n.wbg.__wbindgen_init_externref_table=function(){const e=s.__wbindgen_export_4,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},n.wbg.__wbindgen_is_bigint=function(e){return typeof e=="bigint"},n.wbg.__wbindgen_is_function=function(e){return typeof e=="function"},n.wbg.__wbindgen_is_object=function(e){const t=e;return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_undefined=function(e){return e===void 0},n.wbg.__wbindgen_jsval_eq=function(e,t){return e===t},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return e==t},n.wbg.__wbindgen_memory=function(){return s.memory},n.wbg.__wbindgen_number_get=function(e,t){const r=t,o=typeof r=="number"?r:void 0;b().setFloat64(e+8,w(o)?0:o,!0),b().setInt32(e+0,!w(o),!0)},n.wbg.__wbindgen_number_new=function(e){return e},n.wbg.__wbindgen_string_get=function(e,t){const r=t,o=typeof r=="string"?r:void 0;var i=w(o)?0:g(o,s.__wbindgen_malloc,s.__wbindgen_realloc),_=a;b().setInt32(e+4,_,!0),b().setInt32(e+0,i,!0)},n.wbg.__wbindgen_string_new=function(e,t){return l(e,t)},n.wbg.__wbindgen_throw=function(e,t){throw new Error(l(e,t))},n}function he(n,e){return s=n.exports,re.__wbindgen_wasm_module=e,O=null,f=null,S=null,s.__wbindgen_start(),s}async function re(n){if(s!==void 0)return s;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module_or_path:n}=n:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof n>"u"&&(n=new URL("/moq-wasm/assets/moqt_client_wasm_bg-BQYT2rXe.wasm",import.meta.url));const e=me();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:r}=await pe(await n,e);return he(t,r)}class ye{subgroupObjectHandlers=new Map;setSubgroupObjectHandler(e,t){this.subgroupObjectHandlers.set(e,t)}getSubgroupObjectHandler(e){return this.subgroupObjectHandlers.get(e)}deleteSubgroupObjectHandler(e){this.subgroupObjectHandlers.delete(e)}clearHandlers(){this.subgroupObjectHandlers.clear()}}class Ce{client=null;serverSetupResolve=null;onAnnounceHandler=null;onSubscribeResponseHandler=null;onConnectionClosedHandler=null;incomingSubscribeHandler=null;onServerSetupHandler=null;subscriptionState;constructor(e){this.subscriptionState=e??new ye}async connect(e,t={}){if(!this.getConnectionStatus())try{if(await re(),this.client=new fe(e),await this.client.start(),this.setupCallbacks(),t.sendSetup===!1){this.serverSetupResolve=null;return}const r=new Promise(_=>{this.serverSetupResolve=_}),o=t.versions??new BigUint64Array([0xff00000an]),i=t.maxSubscribeId??100n;await this.client.sendSetupMessage(o,i),await r}catch(r){throw this.cleanupClient(),console.error("Failed to connect MoQT client:",r),r}}async sendSetupMessage(e,t){const r=this.requireConnectedClient(),o=new Promise(i=>{this.serverSetupResolve=i});await r.sendSetupMessage(e,t),await o}async disconnect(){if(this.client)try{await this.client.close()}finally{this.cleanupClient()}}getConnectionStatus(){return!!this.client&&this.client.isConnected()}getRawClient(){return this.client}setOnConnectionClosedHandler(e){this.onConnectionClosedHandler=e}setOnServerSetupHandler(e){this.onServerSetupHandler=e}setOnAnnounceHandler(e){this.onAnnounceHandler=e}setOnSubscribeResponseHandler(e){this.onSubscribeResponseHandler=e}setOnIncomingSubscribeHandler(e){this.incomingSubscribeHandler=e}setOnSubgroupObjectHandler(e,t){this.subscriptionState.setSubgroupObjectHandler(e,t)}clearSubgroupObjectHandler(e){this.subscriptionState.deleteSubgroupObjectHandler(e)}clearSubgroupObjectHandlers(){this.subscriptionState.clearHandlers()}async announce(e,t){await this.requireConnectedClient().sendAnnounceMessage(e,t)}async subscribeAnnounces(e,t){await this.requireConnectedClient().sendSubscribeAnnouncesMessage(e,t)}async subscribe(e,t,r,o,i){const _=this.requireConnectedClient();if(_.isSubscribed(e))return;await _.sendSubscribeMessage(e,t,r,o,0,0,1,0n,0n,0n,i)}async sendSubgroupTextForTrack(e,t,r){const i=this.requireConnectedClient().getTrackSubscribers(e,t);if(!i.length){console.warn(`No subscribers registered for track ${e.join("/")}/${t}`);return}for(const _ of i)await this.sendSubgroupTextForAlias(_,r)}setupCallbacks(){this.client&&(this.client.onSetup(e=>{this.serverSetupResolve&&(this.serverSetupResolve(),this.serverSetupResolve=null),this.onServerSetupHandler?.(e)}),this.client.onAnnounce(e=>{this.onAnnounceHandler?.(e)}),this.client.onAnnounceResponse(e=>{}),this.client.onSubscribe(async(e,t,r)=>{await(this.incomingSubscribeHandler??Se)({subscribe:e,isSuccess:t,code:r,respondOk:(i,_,c)=>this.requireConnectedClient().sendSubscribeOkMessage(e.subscribeId,i,_,c),respondError:(i,_)=>this.requireConnectedClient().sendSubscribeErrorMessage(e.subscribeId,i,_)})}),this.client.onSubscribeResponse(e=>{this.onSubscribeResponseHandler?.(e)}),this.client.onSubscribeAnnouncesResponse(e=>{}),this.client.onSubgroupStreamHeader(e=>{}),this.client.onSubgroupStreamObject((e,t,r)=>{this.subscriptionState.getSubgroupObjectHandler(e)?.(t,r)}),this.client.onConnectionClosed(()=>this.handleConnectionClosed()))}async sendSubgroupTextForAlias(e,t){const r=this.requireConnectedClient(),o=r.getSubgroupState(e);o.headerSent||(await r.sendSubgroupStreamHeaderMessage(e,o.groupId,o.subgroupId,0),r.markSubgroupHeaderSent(e));const _=new TextEncoder().encode(t);await r.sendSubgroupStreamObject(e,o.groupId,o.subgroupId,o.objectId,void 0,_),r.incrementSubgroupObject(e)}handleConnectionClosed(){this.cleanupClient(),this.onConnectionClosedHandler?.()}cleanupClient(){this.client&&(this.client.free(),this.client=null),this.subscriptionState.clearHandlers(),this.serverSetupResolve=null}requireConnectedClient(){if(!this.client||!this.client.isConnected())throw new Error("MOQT client is not connected");return this.client}}const Se=async n=>{if(n.isSuccess){await n.respondOk(0n,"secret","subgroup");return}await n.respondError(BigInt(n.code),"Subscription validation failed")};export{Ce as M,je as p};
